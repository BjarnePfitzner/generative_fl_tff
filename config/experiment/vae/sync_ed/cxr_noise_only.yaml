# @package _global_

defaults:
  - override /model: vae
  - override /dataset: cxr
  - override /evaluation: development
  - override /differential_privacy: noise_only
  - override /training/vae_loss_fn: soft_intro_vae_loss
  #- override /training/early_stopping:
  #    - accuracy
  #    - fid

experiment_name: vae_sync_ed_cxr

training:
  total_rounds: 100
  aggregation_step_optimizer:
    type: SGD
    lr: 1.0
  client_optimizer:
    type: Adam
  clients_per_round: 0.1
  batch_size: 64
  local_epochs: 10
  vae_loss_fn:
    s_intro_beta_kl: 0.5
    s_intro_beta_rec: 0.2
    s_intro_beta_neg: 1024.0

differential_privacy:
  effective_noise: 0.01

evaluation:
  run_fid_eval: False
  plot_l2_norms: True
  rounds_per_eval: 10

model:
  type: sync_ed
  module: soft_intro_res_vae
  latent_dim: 128


hydra:
  sweeper:
    params:
      model.module:
        - soft_intro_res_vae
        - cxr_vae
      differential_privacy.effective_noise:
        - 0.0
        - 0.0001
        - 0.001
        - 0.01
        - 0.05
        - 0.1
      training.clients_per_round:
        - 0.1
        - 0.2
        - 0.5
      training.local_epochs:
        - 1
        - 10
      training.client_optimizer.lr:
        - 0.0001
        - 0.0002
        - 0.0005
        - 0.001
      training.batch_size:
        - 16
        - 32
        - 64
      training.aggregation_step_optimizer.momentum:
        - 0.0
        - 0.5
        - 0.9